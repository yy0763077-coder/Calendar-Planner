# 云数据库索引配置

在**微信开发者工具** → **云开发** → **数据库** → **集合** → **索引管理** 中为以下集合创建索引，可显著提升数据量增大后的查询速度。

> **唯一索引**：勾选「唯一」可防止重复数据，但需确保现有数据无重复，否则创建会失败。

## events 集合

| 索引名称 | 字段 | 排序 | 唯一 | 说明 |
|---------|------|------|:----:|------|
| groupId_1 | groupId | 升序 | 否 | 按组查询行程，一组多行程 |
| groupId_year_month_1 | groupId + year + month | 升序 | 否 | 组合索引，按组和日期查询 |
| year_month_day_groupId | year + month + day + groupId | 升序 | 否 | notifyUsers 按日查询 |

**推荐**：至少创建 `groupId_1`。

## group_members 集合

| 索引名称 | 字段 | 排序 | 唯一 | 说明 |
|---------|------|------|:----:|------|
| openid_1 | openid | 升序 | 否 | 一用户可加入多组 |
| groupId_1 | groupId | 升序 | 否 | 一组多成员 |
| groupId_openid_1 | groupId + openid | 升序 | **是** | 同一组内同一用户仅一条记录 |

## member_profiles 集合

| 索引名称 | 字段 | 排序 | 唯一 | 说明 |
|---------|------|------|:----:|------|
| groupId_1 | groupId | 升序 | 否 | 按组查询成员资料 |
| groupId_memberId_1 | groupId + memberId | 升序 | **是** | 每组成员仅一条资料 |

## users 集合

| 索引名称 | 字段 | 排序 | 唯一 | 说明 |
|---------|------|------|:----:|------|
| openid_1 | openid | 升序 | **是** | 一 openid 对应一用户 |

## groups 集合

| 索引名称 | 字段 | 排序 | 唯一 | 说明 |
|---------|------|------|:----:|------|
| inviteCode_1 | inviteCode | 升序 | **是** | 邀请码全局唯一 |
